<!DOCTYPE html>
<div >
  <h1>{{ctrl.name}} DIRECTION {{ctrl.direction}}</h1>
   <div class="row">
      <div class="col-md-1">
      </div>
      <input id="inlineradio0" type="checkbox" class="col-md-1"
              ng-model="optional"
               ng-checked="ctrl.isOptionalChecked()"
               ng-click="ctrl.setOptionalChecked(optional)">
      <div  class="col-md-9">
          OPTIONAL
       </div>
    </div>
    <div ng-repeat="keyNode in ctrl.keys track by $index" >
         <div ng-repeat="key in keyNode['Keys']" ng-init="parentIndex = $index">
            <h2>{{key}}</h2>
            <div class="row panel" >
                            <div class="col-md-5">
                <div class="panel panel-default top-buffer-small" >
                  <div class="panel-heading">
                        <div class="pull-left" style="width:15px;">
                          <input id="inlineradio0" type="checkbox" 
                           ng-checked="ctrl.isFilterAttributesChecked(key)"
                           ng-click="ctrl.setFilterAttributes(key)">
                        </div>
                        <div class="pull-left left-buffer ">
                           Filter
                        </div>
                        <div class="clearfix"></div>
                  </div>
                  <div ng-if="ctrl.isFilterAttributesChecked(key)" class="panel-body"> 
                    <div ng-repeat="filter in ctrl.getFilterAttributes(key).filters track by $index" class="top-buffer-small">
                      <div class="row top-buffer-small">
                        <div class="col-xs-2 ck-container">
                          <input class="ck-element ck-box" 
                            type="checkbox"
                            ng-model="isBracketOpen"
                            ng-change="ctrl.setFilterAttributesFilterValue(key, filter.id, 'isBracketOpen', isBracketOpen)" 
                            ng-watch='ctrl.getFilterAttributesFilter(key, filter.id)'
                            ng-watch-object-value="isBracketOpen"
                            autocomplete="off">
                           </input> 
                           <div class="ck-element ck-content">
                               <span>(</span> 
                           </div>
                        </div>
                      </div>

                      <!--Panel-->
                      <div class="panel panel-primary" >
                        <div class="panel-body">
                          <button ng-if="ctrl.getFilterAttributes(key).filters.length > 1"
                                  class="btn pull-right" 
                                  ng-click="ctrl.deleteFilterAttributesFilter(key, filter.id)"> 
                           Remove
                          </button>
                          
                          <div>
                           Type
                          </div>
                          <select name="singleSelect" id="singleSelect" class="form-control"
                            ng-model="type"
                            ng-change="ctrl.setFilterAttributesFilterValue(key, filter.id, 'type', type)" 
                            ng-watch='ctrl.getFilterAttributesFilter(key, filter.id)'
                            ng-watch-object-value="type">
                            <option value="string">STRING</option> 
                            <option value="integer">INT</option>
                            <option value="double">DOUBLE</option>
                            <option value="date">DATE</option>
                          </select>
                          <div class="top-buffer-small">
                            Filter Type
                          </div>
                          <select name="singleSelect" id="singleSelect" class="form-control"
                          ng-model="filterType"
                          ng-change="ctrl.setFilterAttributesFilterValue(key, filter.id, 'filterType', filterType)" 
                          ng-watch='ctrl.getFilterAttributesFilter(key, filter.id)'
                          ng-watch-object-value="filterType">
                            <option value="=">EQUALS</option> 
                            <option value="<">GREATER</option>
                            <option value=">">SMALLER</option>
                           <option value="<=">GREATER EQUAL</option>
                            <option value=">=">SMALLER EQUAL</option>
                          </select>
                          <div class="top-buffer-small">
                             Filter
                          </div>
                          <input type="textarea" class="form-control" id="query" 
                              ng-change="ctrl.setFilterAttributesFilterValue(key, filter.id, 'value', value)" 
                              ng-watch='ctrl.getFilterAttributesFilter(key, filter.id)'
                              ng-watch-object-value="value"
                              ng-model="value"/>
                          </input>
                          <div class="input-group top-buffer-small">
                            <div class="panel-title pull-left" style="width:15px;">
                              <input type="checkbox" 
                                 ng-value="true"
                                 ng-model="changeable"
                                 ng-change="ctrl.setFilterAttributesFilterValue(key, filter.id, 'changeable', changeable)"
                                 ng-watch='ctrl.getFilterAttributesFilter(key, filter.id)'
                                 ng-watch-object-value="changeable">
                              </input>
                            </div>
                            <div class="panel-title pull-left left-buffer ">
                              Cangeable
                            </div>
                            <div class="clearfix"></div> 
                          </div>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-xs-2 ck-container">
                          <input class="ck-element ck-box" 
                            type="checkbox"
                            ng-model="isBracketClosed"
                            ng-change="ctrl.setFilterAttributesFilterValue(key, filter.id, 'isBracketClosed', isBracketClosed)" 
                            ng-watch='ctrl.getFilterAttributesFilter(key, filter.id)'
                            ng-watch-object-value="isBracketClosed"
                           autocomplete="off"> 
                           </input>
                           <div class="ck-element ck-content">
                              <span> ) </span>
                           </div>
                        </div>
                      </div>
                      <div ng-if="ctrl.getFilterAttributes(key).filters.length != ($index + 1)">
                        <div class="row">
                          <input  class="col-xs-2" 
                                  style="margin-left: 8.8%"
                                  type="radio" 
                                name="{{'radio' + key + filter.id +  'andOR'}}"
                                value="AND"
                                ng-model="logic"
                                ng-click="ctrl.setFilterAttributesFilterValue(key, filter.id, 'logic', logic)"
                                ng-watch='ctrl.getFilterAttributesFilter(key, filter.id)'
                                ng-watch-object-value="logic">
                          </input>
                          <div class="col-xs-3">AND</div>
                        </div>
                        <div class="row">
                          <input  class="col-xs-2" 
                                  style="margin-left: 8.8%"
                                  type="radio" 
                                name="{{'radio' + key + filter.id + 'andOR'}}"
                                value="OR"
                                ng-model="logic"
                                ng-click="ctrl.setFilterAttributesFilterValue(key, filter.id, 'logic', logic)"
                                ng-watch='ctrl.getFilterAttributesFilter(key, filter.id)'
                                ng-watch-object-value="logic">
                          </input>
                          <div class="col-xs-3">OR</div>
                        </div>
                      </div>
                    </div>
                    <button class="btn" 
                        ng-click="ctrl.addFilterAttributesFilter(key)"> 
                        ADD
                    </button>
                  </div>
                </div>
              </div>
              <div class="col-md-3">
                <div class="panel panel-default top-buffer-small" >
                  <div class="panel-heading">
                    <div class="panel-title pull-left" style="width:15px;">
                      <input id="inlineradio1" type="checkbox"
                                 ng-checked="ctrl.isReturnAttributesChecked(key)"
                                 ng-click="ctrl.setReturnAttributes(key)">
                      </input>
                    </div>
                    <div class="panel-title pull-left left-buffer">
                      Return
                    </div>
                    <div class="clearfix"></div>
                  </div>
                  <div class="panel-body" ng-if="ctrl.isReturnAttributesChecked(key)"> 
                    <div class="row">
                      <input  class="col-xs-2" 
                              style="margin-left: 8.8%"
                             type="checkbox" 
                            name="{{'checkbox' + key + 'returnType'}}"
                            ng-true-value="'distinct'"
                            ng-false-value="''"
                            value="distinct"
                            ng-model="returnType"
                            ng-click="ctrl.setReturnAttributesValue(key, 'returnType', returnType)"
                            ng-watch='ctrl.getReturnAttributes(key)'
                            ng-watch-object-value="returnType">
                      </input>
                      <div class="col-xs-3">Distinct</div>
                    </div>
                    <h3>Aggregation</h3>
                    <div class="row">
                      <input  class="col-xs-2" 
                              style="margin-left: 8.8%"
                              type="radio" 
                            name="{{'radio' + key + 'aggregation'}}"
                            value="NONE"
                            ng-model="aggregation"
                            ng-click="ctrl.setReturnAttributesValue(key, 'aggregation', aggregation)"
                            ng-watch='ctrl.getReturnAttributes(key)'
                            ng-watch-object-value="aggregation">
                      </input>
                      <div class="col-xs-3">NONE</div>
                    </div>
                    <div class="row">
                      <input  class="col-xs-2" 
                              style="margin-left: 8.8%" type="radio" 
                            name="{{'radio' + key + 'aggregation'}}"
                            value="MIN"
                            ng-model="aggregation"
                            ng-click="ctrl.setReturnAttributesValue(key, 'aggregation', aggregation)"
                            ng-watch='ctrl.getReturnAttributes(key)'
                            ng-watch-object-value="aggregation">
                      </input>
                      <div class="col-xs-3">MIN</div>
                    </div>
                    <div class="row">
                      <input  class="col-xs-2" 
                              style="margin-left: 8.8%" type="radio" 
                            name="{{'radio' + key + 'aggregation'}}"
                            value="MAX"
                            ng-model="aggregation"
                            ng-click="ctrl.setReturnAttributesValue(key, 'aggregation', aggregation)"
                            ng-watch='ctrl.getReturnAttributes(key)'
                            ng-watch-object-value="aggregation">
                      </input>
                      <div class="col-xs-3">MAX</div>
                    </div>
                    <div class="row">
                      <input  class="col-xs-2" 
                              style="margin-left: 8.8%" type="radio" 
                            name="{{'radio' + key + 'aggregation'}}"
                            value="SUM"
                            ng-model="aggregation"
                            ng-click="ctrl.setReturnAttributesValue(key, 'aggregation', aggregation)"
                            ng-watch='ctrl.getReturnAttributes(key)'
                            ng-watch-object-value="aggregation">
                      </input>
                      <div class="col-xs-3">SUM</div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-3">
                <div class="panel panel-default top-buffer-small" >
                    <div class="panel-heading">
                      <div class="panel-title pull-left" style="width:15px;">
                        <input  type="checkbox" 
                        ng-checked="ctrl.isOrderByAttributesChecked(key)"
                        ng-click="ctrl.setOrderByAttributes(key)">
                        </input>
                      </div>
                      <div class="panel-title pull-left left-buffer" >
                        Order
                      </div>
                      <div class="clearfix"></div>
                    </div>
                    <div class="panel-body" ng-if="ctrl.isOrderByAttributesChecked(key)">
                       
                       <div class="row">
                          <input  class="col-xs-2" 
                              style="margin-left: 8.8%" type="radio" 
                            name="{{'radio' + key}}"
                            value="asc"
                            ng-model="value"
                            ng-click='ctrl.setOrderByAttributesValue(key, value)'
                            ng-watch='ctrl.getOrderByAttributes(key)'
                            ng-watch-object-value="direction">
                          </input>
                          <div class="col-xs-3">ASC</div>
                        </div>
                        <div class="row">
                          
                           <input class="col-xs-2" 
                                style="margin-left: 8.8%"
                                class="btn btn-primary" type="radio" 
                            name="{{'radio' + key}}"
                            value="desc"
                            ng-model="value"
                            ng-click='ctrl.setOrderByAttributesValue(key, value)'
                            ng-watch='ctrl.getOrderByAttributes(key)'
                            ng-watch-object-value="direction">
                            <div class="col-xs-3">DESC</div>
                          </input>
                         </div>
                  
                      </div>
                    </div>
                </div>            
              </div>
            </div>
          </div>
      </div>
</div>