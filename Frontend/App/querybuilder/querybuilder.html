<!DOCTYPE html>
<div class="container" ng-controller="queryBuilderCtrl as ctrl">
  
  <div class="row top-buffer-small">
    <div>
      <button class="btn btn-default" ng-click="ctrl.executeQuery()">Execute Query</button>
      <button ng-if='ctrl.query["id"] === ""'
              class="btn btn-default" ng-click="ctrl.saveQuery()">Save Query</button>
       <button ng-if='ctrl.query["id"] !== ""'
              class="btn btn-default" ng-click="ctrl.updateQuery()">Update Query</button>
      <button ng-if='ctrl.query["id"] !== ""'
              class="btn btn-default" ng-click="ctrl.deleteQuery()">Delete Query</button>
      <button class="btn btn-default" ng-click="ctrl.loadQuery()">Load Query</button>
      <button class="btn btn-default" ng-click="ctrl.newQuery()">New Query</button>
    </div>
  </div>

  <div class="row">
      <h1>Name</h1>
      <input type="textarea" class="form-control" id="query" 
            ng-model="ctrl.query['name']"   placeholder="Name" />
  </div>
  <div class="row">
      <h1>Description</h1>
      <input type="textarea" class="form-control" id="query" 
            ng-model="ctrl.query['description']"  placeholder="Description" />
  </div>
  <div class="row">
      <h1>Category</h1>
      <select  ng-model="ctrl.query['category']" ng-change="ctrl.query['category']"
      style="width: 100%; display:block; margin-bottom: 5px">
          <option ng-repeat="category in ctrl.availableCategories"> {{category.name}} </option>
      </select>
  </div>
  
  <div class="row">
      <h1>Limit</h1>
      <input type="textarea" class="form-control" id="query"
            ng-model="ctrl.query['limitCount']"  placeholder="Limit Count" />
  </div>
  

  <div class="row" ng-if="ctrl.availableNodes.length > 0">
      <h1>Choose Node</h1>
        <div ng-repeat="node in ctrl.availableNodes" style="display: inline;">
          <button ng-repeat="nodeText in node['Label']" ng-click="ctrl.addNode(nodeText)" class="btn btn-default">
          {{nodeText}}
          </button>
        </div>
  </div>
  <div class="row" ng-if="ctrl.availableNodes.length === 0">
    <div class="panel panel-default top-buffer"
         ng-class="{'col-md-8': ctrl.selectedNode != undefined, 
                    'col-md-12': ctrl.selectedNode == undefined}">
      <div class="panel-body">
        <vis-network ng-if="ctrl.availableNodes.length == 0"
              ng-model="ctrl.network_data"
              options="ctrl.network_options" 
              on-select-click="ctrl.onSelectClick(params, network)"
              on-double-click="ctrl.onDoubleClick(params, network)"
              id="previewNetwork">
        </vis-network>
      </div>
    </div>
    <div class="col-md-1">
    </div>
    <div class="panel panel-default top-buffer col-md-3" 
      ng-if="ctrl.selectedNode != undefined">
      <div class="panel-body">
        <h1>{{ctrl.selectedNode['type']}}</h1>
        <button ng-click="ctrl.deleteSelectedNode()">
          Delete
        </button>
      </div>
    </div>
  </div>
  

<!--   <h1>TEST: {{ctrl.table}}</h1> -->
  
  <div class="row top-buffer">
    <table class="table"  ng-if="!ctrl.hasError">
        <h1>Result</h1>
       {{ctrl.table}}
    </table>


    <div ng-if="ctrl.hasError">
        <div class="row">
            <div class="col-md-3">Error</div>
            <div class="col-md-9">{{ctrl.error['error']}}</div>
        </div>
        <div class="row">
            <div class="col-md-3">Exception</div>
            <div class="col-md-9">{{ctrl.error['exception']}}</div>
        </div>
        <div class="row">
            <div class="col-md-3">Message</div>
            <div class="col-md-9">{{ctrl.error['message']}}</div>
        </div>
    </div>

  </div>
 
</div>