<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../">
  <title data-ice="title">App/user/user.js | API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  </ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">App/user/user.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">&apos;use strict&apos;;

angular.module(&apos;queryBuilder.user&apos;, [&apos;ngRoute&apos;, &apos;queryBuilder.services&apos;])

.config([&apos;$routeProvider&apos;, function($routeProvider) {
  $routeProvider.when(&apos;/user&apos;, {
    templateUrl: &apos;user/user.html&apos;
  });
}])
.controller(&apos;userCtrl&apos;, [&apos;$requests&apos;,
	function($requests) {
	var self = this;
	

	/**
     * Holds email of selected user.
     * @type {string}
     */
	self.email = &quot;&quot;;

	 /**
     * Stores all Users which exists.
     * @type {array}
     */	
  	self.existingUsers = [];

	/**
     * Store all authorities of selected user.
     * @type {array}
     */
  	self.authorities = [];

	/**
     * Store all roles of the user which can be selected and changed.
     * @type {array}
     */
   	self.roles = [
   	 &apos;EXPERTMODE&apos;, 
  	 &apos;CATEGORY&apos;, 
   	 &apos;ALERT&apos;, 
   	 &apos;ALERTSTATISTIC&apos;
  	];

	/**
     * Holds the error string which is displayed to the user.
     * The table is only shown when the hasError property is set to TRUE.
     * @type {string}
     */
	self.error = &quot;&quot;;
	/**
     * If there was an error during the execution of the query this is set to 
     * true and the error will be displayed. Otherwise the table will be displayed.
     * @type {boolean}
     */
	self.hasError = false;
	
	/**
	 * Callback from delete/save category call. If query was successful refresh category names.
	 * Otherwise print error.
	 *
	 * @param {boolean} $success - true when there are no errors.
	 * @param {Object} $data - the requested data.
     * @param {number} $status - the actual server status.
	 */
	self.callback = function($success, $data, $status) {
		self.hasError = !$success;
		if($success){
			$requests.getAllUsers(self.getUsers);
		}
		else
		{
			self.error = $data;
		}
	}
	/**
	 * Callback from get all users call. If query was successful save data in variable self.existingUsers.
	 * Otherwise print error.
	 * 
	 * @param {boolean} $success - true when there are no errors.
	 * @param {Object} $data - the requested data (In this case the users).
     * @param {number} $status - the actual server status.
	 */
	self.getUsers = function($success, $data, $status) {
		self.hasError = !$success;
		if($success){
			self.existingUsers = $data;

		}
		else
		{
			self.error = $data;
		}
	}	
	$requests.getAllUsers(self.getUsers);

	/**
    * This method searches for a certain role with a certain role name (key).
    *
    * @param {string} $key - The key of the role. The key is the same as the role name.
    * @return {Object} The given role name or undefined.
    */
	self.getRoles = function($key){	
		for (var i = 0; i &lt; self.authorities.length; i++) {
			if(self.authorities[i].authority === $key){
				return $key;	
			}
		}
		return undefined;
	};

	/**
    * Checks whether a certain role with a role name (key) exists or not.
    *
    * @param {string} $key - The role key. The key is the same as the role name.
    * @return {boolean} True if the role with the given key exists, otherwise false.
    */
	self.isRoleChecked = function($key){
		if(self.getRoles($key) === undefined){
			return false;
		}
		return true;
	};

	/**
        * Checks whether a certain role with a certain key exists or not.
        * If it exists it removes the role, if not it creates the role.
        * 
        * @param {string} $key - The key of the property which should be added or deleted.
        */
    self.setFilterAttributes = function($key){
        var filterAttribute = self.getRoles($key);
			if(filterAttribute !== undefined){
                $requests.deleteAuthority(self.email, $key, self.callback)

            } else {
                $requests.addAuthority(self.email, $key, self.callback)
            }

    }

	/**
	 * Callback from get all authorities call. If query was successful save data in variable self.authorities.
	 * Otherwise print error.
	 * 
	 * @param {boolean} $success - true when there are no errors.
	 * @param {Object} $data - the requested data (In this case the authorities).
     * @param {number} $status - the actual server status.
	 */
    self.getAuthorities = function($success, $data, $status) {
		self.hasError = !$success;
		if($success){
			self.authorities = $data;
		}
		else
		{
			self.error = $data;
		}
	}

	/**
	 * Load selected authorities of selected user.
	 * 
	 * @param {Object} $query - Load this query.
	 */
    self.selectLoad = function($query) {
        $requests.getAllAuthorities($query.email, self.getAuthorities);
        self.email = $query.email;
    }		
}]);</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.5.2)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
