<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../">
  <title data-ice="title">App/outputTable.js | API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  </ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">App/outputTable.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">(function(angular) {
  &apos;use strict&apos;;
angular.module(&apos;OutputTable&apos;, [])
  .controller(&apos;Controller&apos;, [&apos;$scope&apos;, function($scope) {

    /**
	  * Function for changing the data from which the table should be built.
	  * 
    * @param {Object} $data - Data from which the ouptput table should be built.
	  */
    $scope.setData = function (data) {
        $scope.input = data;
        $scope.data = convertTableWidgetData(data);
    }

    /**
	  * Function for converting the Data from the database to a table.
	  * 
    * @param {Object} $widgetData - Data from which the ouptput table should be built.
	  */                
    function convertTableWidgetData(widgetData) {
      var headerData = getTableHeader(widgetData);
      var bodyData = getTableBody(widgetData);
      return {tableHeader:headerData, tableBody:bodyData};
    }

    /**
	  * Function creating the header of the table.
	  * 
    * @param {Object} $widgetData - Data from which the ouptput table should be built.
	  */  
    function getTableHeader(data){
      var headerData = convertTableHeader(data[0], 1);
      var maxLevel = 0;
      for(var i=0;i&lt;headerData.length;i++){
        if(headerData[i].level&gt;maxLevel){
          maxLevel = headerData[i].level;
        }
      }
      var tableColumns = [];
      for (var level = 1; level &lt;= maxLevel; level++) {
        var headerRow = [];
        for (var i = 0; i &lt; headerData.length; i++) {
          if (headerData[i].level == level) {
            var rowSpan = 1;
            if (headerData[i].elementType == &quot;primitive&quot;) {
              rowSpan = maxLevel - headerData[i].level + 1;
            }
            headerRow.push({title: headerData[i].title,colspan:headerData[i].colspan,rowspan:rowSpan});
          }
        }
        tableColumns.push(headerRow);
      }
      return tableColumns;
    }

    /**
	  * Function for converting the data to headings for the output table.
	  * 
    * @param {Object} $data - Data from which the ouptput table should be built.
    * @param {Object} $level - Level of the table in which the heading should be.
	  */      
    function convertTableHeader(data, level) {
      var headerData = [];
      for (var prop in data) {
        if (typeof data[prop] == &apos;object&apos; &amp;&amp; data[prop] != null) {
          var subHeaderData = convertTableHeader(data[prop], level + 1);                
          var colspan = 0;
          for(var i=0;i&lt;subHeaderData.length;i++){
            colspan += subHeaderData[i].colspan;
            headerData.push(subHeaderData[i]);
          }
          headerData.push({ title: prop, level: level, colspan: colspan, elementType: &quot;object&quot;});
        }
        else{
          headerData.push({ title: prop, level: level, colspan: 1, elementType: &quot;primitive&quot;});
        }
      }
      return headerData;
    }

    /**
	  * Function creating the body of the table.
	  * 
    * @param {Object} $widgetData - Data from which the ouptput table should be built.
	  */  
    function getTableBody(data){
      var tableRows = [];
      for(var j = 0;j &lt; data.length; j++){
        var bodyData = convertTableBody(data[j], 1);
        var maxLevel = 0;
        for(var i=0;i&lt;bodyData.length;i++){
          if(bodyData[i].level&gt;maxLevel){
            maxLevel = bodyData[i].level;
          }
        }
        for (var level = 1; level &lt;= maxLevel; level++) {
          var row = [];
          for (var i = 0; i &lt; bodyData.length; i++) {
            if (bodyData[i].level == level) {
              var rowSpan = 1;
              if (bodyData[i].elementType == &quot;primitive&quot;) {
                rowSpan = maxLevel - bodyData[i].level + 1;
              }
              row.push({title: bodyData[i].title,colspan:bodyData[i].colspan,rowspan:rowSpan});
            }
          }
          tableRows.push(row);
        }
      }
      return tableRows;
    }

    /**
	  * Function for converting the data to body rows and columns for the output table.
	  * 
    * @param {Object} $data - Data from which the ouptput table should be built.
    * @param {Object} $level - Level of the table in which the body data should be.
	  */
    function convertTableBody(data, level) {
      var bodyData = [];
      for (var prop in data) {
        if (typeof data[prop] == &quot;object&quot; &amp;&amp; data[prop] != null) {
          var subBodyData;
            subBodyData = convertTableBody(data[prop], level + 1);             
            var colspan = 0;
            for(var j=0;j&lt;subBodyData.length;j++){
              colspan += subBodyData[j].colspan;
              subBodyData[j].elementType = &quot;object&quot;;
              bodyData.push(subBodyData[j]);
            }  
        }
        else{
          bodyData.push({ title: data[prop], level: level, colspan: 1, elementType: &quot;primitive&quot;});
        }
      }
      return bodyData;
    }
  }]
)

  /**
	* Directive to denote how the table should look like.
	* 
	*/
 .directive(&apos;outputtable&apos;, function() {
     return {
        scope: {
            table: &apos;=&apos;,
            setData: &apos;&amp;&apos;,
            data: &apos;=&apos;
        },
        template : &apos;&lt;table  class=&quot;table table-responsive&quot;&gt;&lt;thead&gt;&lt;tr ng-repeat=&quot;headline in $parent.data.tableHeader&quot;&gt;&lt;th ng-repeat=&quot;headlineColumn in headline&quot; rowspan=&quot;{{headlineColumn.rowspan}}&quot; colspan=&quot;{{headlineColumn.colspan}}&quot;&gt;{{headlineColumn.title}}&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr ng-repeat=&quot;row in $parent.data.tableBody&quot;&gt;&lt;td ng-repeat=&quot;rowColumn in row&quot; rowspan=&quot;{{rowColumn.rowspan}}&quot; colspan=&quot;{{rowColumn.colspan}}&quot;&gt;{{rowColumn.title}}&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&apos;,
    
        link: function(scope, el, attr) {
              var thisscope = scope;

              /**
	            * Function to watch for changes on the data, if changes happens the data is set to the new data.
	            * 
              * @param {Object} $newvalue - new value of the data.
              * @param {Object} $oldvalue - old value of the data.
	            */
              scope.$watch(&apos;table&apos;, function(newvalue, oldvalue) {
            	  if(newvalue !== undefined)
        		  {
                    thisscope.$parent.setData(newvalue);
        		  }
              }, true);
        }
      };
 });
})(window.angular); 

</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.5.2)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
