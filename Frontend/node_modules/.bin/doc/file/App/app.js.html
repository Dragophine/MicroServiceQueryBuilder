<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../">
  <title data-ice="title">App/app.js | API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  </ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">App/app.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">&apos;use strict&apos;;

// Declare app level module which depends on views, and components
var app = angular.module(&apos;queryBuilder&apos;, [
  &apos;ngRoute&apos;,
  &apos;ngDialog&apos;,
  &apos;queryBuilder.header&apos;,
  &apos;queryBuilder.services&apos;,
  &apos;queryBuilder.login&apos;,
  &apos;loginService&apos;,
  &apos;queryBuilder.expertMode&apos;,
  &apos;queryBuilder.register&apos;,
  &apos;queryBuilder.querybuilder&apos;,
  &apos;queryBuilder.querybuildernodedialog&apos;,
  &apos;queryBuilder.querybuilderrelationshipdialog&apos;,
  &apos;queryBuilder.querybuilderLoadDialog&apos;,
  &apos;queryBuilder.querybuilderInfoDialog&apos;,
  &apos;OutputTable&apos;,
  &apos;queryBuilder.alerting&apos;,
  &apos;queryBuilder.alertingStatistics&apos;,
  &apos;queryBuilder.category&apos;,
  &apos;queryBuilder.user&apos;,
  &apos;expertMode.loadDialogExpertMode&apos;
])
.config([&apos;$routeProvider&apos;, function($routeProvider) {
  $routeProvider.when(&apos;/&apos;, {
    templateUrl: &apos;login/login.html&apos;,
    controller: &apos;LoginCtrl&apos;,
        controllerAs: &apos;login&apos;
  })
  .when(&apos;/register&apos;, {
      templateUrl: &apos;register/register.html&apos;
  })
  .when(&apos;/login&apos;, {
      templateUrl: &apos;login/login.html&apos;
  })
  .otherwise ({ redirectTo: &apos;login/login.html&apos;
  });
}])

.run(function ($rootScope, $cookies, $location) {
  $rootScope.$on(&quot;$locationChangeStart&quot;, function (event, next, current) {
      //console.log(&quot;AUTH&quot;+$rootScope.authenticated);
    if (!$rootScope.authenticated &amp;&amp; ( $location.path() == &quot;/querybuilder&quot; || 
    $location.path() == &quot;/category&quot; || $location.path() == &quot;/alerting&quot; || $location.path() == &quot;/alertingStatistics&quot;)) {
      $location.path(&quot;/login&quot;);
    }
    if (!$rootScope.admin &amp;&amp; ($location.path() == &quot;/user&quot; )) {
         $location.path(&quot;/querybuilder&quot;);
    }
    if (!$rootScope.expertMode &amp;&amp; !$rootScope.admin &amp;&amp; ($location.path() == &quot;/expertmode&quot; )) {
         $location.path(&quot;/querybuilder&quot;);
    }
    if (!$rootScope.category &amp;&amp; !$rootScope.admin &amp;&amp; ($location.path() == &quot;/category&quot; )) {
         $location.path(&quot;/querybuilder&quot;);
    }
    if (!$rootScope.alert &amp;&amp; !$rootScope.admin &amp;&amp; ($location.path() == &quot;/alerting&quot; )) {
         $location.path(&quot;/querybuilder&quot;);
    }
    if (!$rootScope.alertStatistic &amp;&amp; !$rootScope.admin &amp;&amp;  ($location.path() == &quot;/alertingStatistics&quot; )) {
         $location.path(&quot;/querybuilder&quot;);
    }

  });
  /**
   *  Holds the query of the query builder in cypher language. 
   *  @type {string}
   */
  $rootScope.queryBuilderQueryInCypher = undefined;
  /**
   *  Holds the old query of the query builder.
   *  @type {string}
   */
  $rootScope.queryBuilderOldQuery = undefined;
 /**
   *  Holds the query of the expert mode.
   *  @type {string}
   */
  $rootScope.expertQuery  = undefined;
});

/**
 * This directive handles the content behind the vis.js network.
 * The options of the network, the data of the network must be
 * provided by the caller.
 * Furthermore, function can be defined which are called when 
 * a user clicks a node or a edge or a user double clicks a item.
 * 
 * @version 1.0.0
 */
app.directive(&apos;visNetwork&apos;, function() {
    return {
        restrict: &apos;E&apos;,
        require: &apos;^ngModel&apos;,
        scope: {
            ngModel: &apos;=&apos;,
            data: &apos;=&apos;,
            options: &apos;=&apos;,
            onNodeClick: &apos;&amp;&apos;,
            onEdgeClick: &apos;&amp;&apos;,
            onSelectClick: &apos;&amp;&apos;,
            onDoubleClick: &apos;&amp;&apos;
        },
        link: function($scope, $element, $attrs, ngModel) {
            var $network = new vis.Network($element[0], $scope.data || 
                  {nodes: undefined,
                    edges: undefined}, $scope.options || {});
            $scope.ngModel = $network;

            var onNodeClick = $scope.onNodeClick || function(prop) {};
            var onEdgeClick = $scope.onEdgeClick || function(prop) {};
            var onSelectClick = $scope.onSelectClick || function(prop) {};
            var onDoubleClick = $scope.onDoubleClick || function(prop) {};
 
            $network.on(&apos;selectNode&apos;, function (params)  {
                onNodeClick({params: params, network: $network});
            });

            $network.on(&apos;selectEdge&apos;, function(params) {
                onEdgeClick({params: params, network: $network});
            });
            
            $network.on(&apos;select&apos;, function(params) {
                onSelectClick({params: params, network: $network});
            });

            $network.on(&apos;doubleClick&apos;, function(params) {
                onDoubleClick({params: params, network: $network});
            });
        }
    }
});

/**
 *
 * With this directive one can watch not only the changes of the model
 * but also the changes within a certain model (subproberty of the model).
 * If there was a change the visualisation will be updated.
 *
 * @version 1.0.0
 */
app.directive(&apos;ngWatch&apos;, function() {
    return {
        restrict: &apos;A&apos;,
        require: &apos;ngModel&apos;,
        scope: {
            ngModel: &apos;=&apos;, 
            ngWatch: &apos;=&apos;, /* whatches an object for change*/

            ngWatchObjectValue: &quot;@&quot; /* set changed value to model*/
        },
        link: function($scope, $element, $attrs, ngModel) {

            $scope.$watch(&apos;ngWatch&apos;, function(newValue, oldValue) {
                if (newValue){
                  if($scope.ngWatchObjectValue){
                    ngModel.$setViewValue(newValue[$scope.ngWatchObjectValue]);
                  }
                  else{
                    ngModel.$setViewValue(newValue);
                  }
                  ngModel.$render();
                }      
            }, true);
        }
    }
});

</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.5.2)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
